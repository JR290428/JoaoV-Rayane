<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Confirma√ß√£o de Presen√ßa</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8fdf9;
      color: #2e3d32;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    header { padding: 20px; }
    h1 { color: #4a6b51; margin-bottom: 10px; }
    .explicacao { font-size: 1.1em; margin-bottom: 20px; color: #3c4f42; }

    .search-box {
      margin: 10px auto;
      width: 80%; max-width: 500px;
      padding: 10px; border: 2px solid #4a6b51;
      border-radius: 12px; font-size: 1em;
    }
    .lista-convidados {
      text-align: left; max-width: 600px; margin: 20px auto;
      background: #fff; border-radius: 12px; padding: 15px;
      box-shadow: 0px 4px 8px rgba(0,0,0,0.1);
      max-height: 300px; overflow-y: auto;
    }
    .grupo { font-weight: bold; color: #4a6b51; margin-top: 15px; }
    label { display: block; margin: 5px 0; cursor: pointer; }
    input[type="checkbox"] { margin-right: 8px; }

    .selecionados {
      margin: 20px auto; max-width: 600px; text-align: left;
      background: #e9f5ee; border: 2px solid #4a6b51;
      border-radius: 12px; padding: 10px;
    }
    .selecionado-item {
      display: inline-block; background: #4a6b51; color: white;
      padding: 5px 10px; border-radius: 20px; margin: 5px;
      font-size: 0.9em;
    }
    .selecionado-item span { margin-left: 8px; cursor: pointer; font-weight: bold; }

    .observacao {
      margin: 20px auto; width: 80%; max-width: 500px; display: block;
      padding: 10px; border-radius: 12px; border: 2px solid #4a6b51; font-size: 1em;
    }
    .btn {
      background: #4a6b51; color: white; border: none; padding: 12px 25px;
      margin-top: 20px; border-radius: 25px; font-size: 1.1em;
      cursor: pointer; transition: background 0.3s;
    }
    .btn:hover { background: #3b5742; }
    .msg-final { margin-top: 20px; color: #4a6b51; font-weight: bold; }
  </style>
</head>
<body>

  <header>
    <h1>Confirma√ß√£o de Presen√ßa</h1>
    <p class="explicacao">Pesquise e selecione o seu nome e de sua fam√≠lia.  
    Voc√™ pode escolher mais de um nome antes de confirmar.</p>
  </header>

  <input type="text" id="search" class="search-box" placeholder="Digite seu nome...">

  <div class="lista-convidados" id="listaConvidados"></div>

  <div class="selecionados" id="selecionados">
    <p><strong>Nomes selecionados:</strong></p>
  </div>

  <textarea id="observacao" class="observacao" placeholder="Observa√ß√µes (opcional)"></textarea>

  <button class="btn" onclick="enviarConfirmacao()">Confirmar Presen√ßa</button>

  <p class="msg-final" id="msg"></p>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxauy9GnIKvDGEHsGTC1RqSZ-qzbWF4afwHwj_meMWUxZJGfAAiSnxccrIdUiMw3-hrrQ/exec";

    const convidados = {
      "Fam√≠lia Velho": [
        "Aline Inacio Velho", "Claudia Alvarenga", "Cristhian Dondossola", "Davi Marcos",
        "Evelyn Marcos", "Fabiula Velho da Silva", "Fabio Fachin", "Henrique Marcos",
        "Lucas Patrick Todescato Velho da Silva", "Luis Angelo Barcelos", "Maria Vitoria Todescato Velho da Silva",
        "Raquel Medeiros Velho", "Sonia Alvarenga", "Wilmar Marcos"
      ],
      "Fam√≠lia Zanolli": [
        "Ana Beatriz Zanolli Vitorassi", "Ana Cecilia Zanolli Vitorassi", "Ana Paula Mendes Zanolli",
        "Antonio Zanolli", "Antonio Zilli Zanolli", "Antonella", "Bernardo Zanolli", "Carine Brigido",
        "Cecilia Zanolli", "Diego Vitorassi", "Eduardo Bortolini", "Fernando Zanolli", "Gabriela Zanolli",
        "Henry Luis", "Humberto Mendes Zanolli", "Ivone de Souza Zanolli", "Jose Zanolli",
        "Juciane Mendes Zanolli", "Laura Reus", "Lino Zanolli", "Lisi Oliveira", "Lorenzzo Zanolli",
        "Luis Fernando Zanolli", "Maria Julia Zanolli", "Maria Luiza Zanolli", "Patricia Viana Zanolli",
        "Pedro Elias", "Priscila Dal Pont", "Rafaela Laitano", "Santina Della Bruna Zanolli",
        "Valdete Zanolli", "William Zanolli", "Arthur Zilli Zanolli", "Bento ou Aurora", "Davi Oliveira"
      ],
      "Fam√≠lia Mendes": [
        "Cleidi Romancini", "Dilma Mendes", "Eliane Mendes", "Joana Romancini", "Julia Romancini",
        "Lucas Mendes", "Marcos Mendes", "Mayara Mendes", "Monique Mendes", "Ricardo Romancini",
        "Vitor", "Edi Mendes"
      ],
      "Amigos": [
        "Afonso Henrique Mota", "Angela", "Antoni Rodrigues Votri", "Cris Rodrigues", "Daura",
        "Dener Votri", "Enzo Barboza", "Erick Maria", "Ezequiel", "Gabriele Mazzuchello",
        "Hilario Biff", "Jauri", "Joao Vitor Silva", "Joaquim", "Juliana Daura", "Juliana Scussel Aguiar",
        "Kemily Scarpati", "Liv√≠a Rodrigues Votri", "Lucas Schardosim", "Luana Barboza", "Manu",
        "Mariane Aguiar", "Maria Luiza Laitano", "Max", "Monica", "Paulo", "Paulo Solano Barboza",
        "Pedro Henrique Reis Carvalho", "Mayara Ju", "Cristina Rodrigues"
      ]
    };

    let selecionados = [];

    function renderLista(filtro = "") {
      const lista = document.getElementById("listaConvidados");
      lista.innerHTML = "";

      Object.keys(convidados).forEach(grupo => {
        const nomesFiltrados = convidados[grupo].filter(nome =>
          nome.toLowerCase().includes(filtro.toLowerCase())
        );
        if (nomesFiltrados.length > 0) {
          const grupoDiv = document.createElement("div");
          grupoDiv.innerHTML = `<p class='grupo'>${grupo}</p>`;
          nomesFiltrados.sort().forEach(nome => {
            const id = grupo + "-" + nome;
            grupoDiv.innerHTML += `
              <label>
                <input type="checkbox" value="${grupo} - ${nome}" onchange="toggleSelecionado(this)">
                ${nome}
              </label>`;
          });
          lista.appendChild(grupoDiv);
        }
      });
    }

    function toggleSelecionado(checkbox) {
      const valor = checkbox.value;
      if (checkbox.checked) {
        selecionados.push(valor);
      } else {
        selecionados = selecionados.filter(item => item !== valor);
      }
      renderSelecionados();
    }

    function renderSelecionados() {
      const box = document.getElementById("selecionados");
      box.innerHTML = "<p><strong>Nomes selecionados:</strong></p>";
      selecionados.forEach(nome => {
        const span = document.createElement("span");
        span.className = "selecionado-item";
        span.innerHTML = `${nome} <span onclick="removerSelecionado('${nome}')">x</span>`;
        box.appendChild(span);
      });
    }

    function removerSelecionado(nome) {
      selecionados = selecionados.filter(item => item !== nome);
      renderSelecionados();
      document.querySelectorAll(`input[value="${nome}"]`).forEach(el => el.checked = false);
    }

    function enviarConfirmacao() {
      if (selecionados.length === 0) {
        alert("Por favor, selecione pelo menos um nome.");
        return;
      }

      const observacao = document.getElementById("observacao").value;
      const formData = new FormData();
      formData.append("nomes", selecionados.join(","));
      formData.append("observacao", observacao);

      fetch(SCRIPT_URL, { method: "POST", body: formData })
        .then(response => response.text())
        .then(() => {
          document.getElementById("msg").innerText = "Confirma√ß√£o enviada com sucesso! üíö";
          selecionados = [];
          renderSelecionados();
          document.getElementById("observacao").value = "";
          document.querySelectorAll("input[type='checkbox']").forEach(cb => cb.checked = false);
        })
        .catch(err => alert("Erro ao enviar: " + err));
    }

    document.getElementById("search").addEventListener("input", (e) => {
      renderLista(e.target.value);
    });

    renderLista();
  </script>

</body>
</html>
