<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Confirma√ß√£o de Presen√ßa</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #ffffff;
      color: #333;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    .container {
      max-width: 600px;
      margin: 30px auto;
      padding: 20px;
      background: #f8f8f8;
      border-radius: 15px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #4a6b51;
    }
    p {
      margin-bottom: 20px;
    }
    input[type="text"], textarea, select {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 10px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #4a6b51;
      color: white;
      padding: 12px 20px;
      margin-top: 15px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background-color: #3d5944;
    }
    .msg-sucesso {
      margin-top: 20px;
      font-weight: bold;
      color: #4a6b51;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Confirma√ß√£o de Presen√ßa üíö</h1>
    <p>Pesquise e selecione o seu nome e da sua fam√≠lia abaixo:</p>

    <input type="text" id="search" placeholder="Digite seu nome..." onkeyup="filtrarNomes()">
    
    <select id="nomes" multiple size="8"></select>

    <textarea id="observacao" placeholder="Observa√ß√µes (opcional)"></textarea>

    <button onclick="enviarResposta()">Confirmar Presen√ßa</button>

    <p class="msg-sucesso" id="mensagem"></p>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby2BAQA7KCrNUo-gexX4JYbyTHrA15-vfGc6ObNUlq-dnqp1vrLQtODPYKd8qR4ZCqsHg/exec";

    // Lista fixa de convidados
    const convidados = [
      "Raquel Medeiros Velho - Fam√≠lia Velho",
      "Luis - Fam√≠lia Velho",
      "Fabi - Fam√≠lia Velho",
      "Kiki - Fam√≠lia Velho",
      "Aline - Fam√≠lia Velho",
      "Wilmar - Fam√≠lia Velho",
      "Vevy - Fam√≠lia Velho",
      "F√°bio Vevy - Fam√≠lia Velho",
      "Davi - Fam√≠lia Velho",
      "Henrique - Fam√≠lia Velho",
      "Claudia - Fam√≠lia Velho",
      "Dona Sonia - Fam√≠lia Velho",
      "Maria - Fam√≠lia Velho",
      "Lucas - Fam√≠lia Velho",
      "Juci - Fam√≠lia Zanolli",
      "Toni - Fam√≠lia Zanolli",
      "Paula - Fam√≠lia Zanolli",
      "Diego - Fam√≠lia Zanolli",
      "Bia - Fam√≠lia Zanolli",
      "Cecilia - Fam√≠lia Zanolli",
      "Humberto - Fam√≠lia Zanolli",
      "Laura - Fam√≠lia Zanolli",
      "V√≥ Santa - Fam√≠lia Zanolli",
      "Dete - Fam√≠lia Zanolli",
      "Maria Julia - Fam√≠lia Zanolli",
      "Tonton - Fam√≠lia Zanolli",
      "Gabi - Fam√≠lia Zanolli",
      "Pedro - Fam√≠lia Zanolli",
      "Henry - Fam√≠lia Zanolli",
      "Pati - Fam√≠lia Zanolli",
      "Fe - Fam√≠lia Zanolli",
      "Luis Fernando - Fam√≠lia Zanolli",
      "Pri - Fam√≠lia Zanolli",
      "Lorenzo - Fam√≠lia Zanolli",
      "Ivonete - Fam√≠lia Zanolli",
      "Z√© - Fam√≠lia Zanolli",
      "Maria Luiza - Fam√≠lia Zanolli",
      "Edu - Fam√≠lia Zanolli",
      "William - Fam√≠lia Zanolli",
      "Carine - Fam√≠lia Zanolli",
      "Be - Fam√≠lia Zanolli",
      "Lino - Fam√≠lia Zanolli",
      "Lise - Fam√≠lia Zanolli",
      "Davi Lise - Fam√≠lia Zanolli",
      "Antonio - Fam√≠lia Zanolli",
      "Rafa - Fam√≠lia Zanolli",
      "Arthur - Fam√≠lia Zanolli",
      "Baby - Fam√≠lia Zanolli",
      "Julia - Fam√≠lia Zanolli",
      "V√≥ Dilma - Fam√≠lia Mendes",
      "Cleide - Fam√≠lia Mendes",
      "Ricardo - Fam√≠lia Mendes",
      "Julia Mendes - Fam√≠lia Mendes",
      "Joana - Fam√≠lia Mendes",
      "Kety - Fam√≠lia Mendes",
      "Rafa Keli - Fam√≠lia Mendes",
      "Junior - Fam√≠lia Mendes",
      "Monique - Fam√≠lia Mendes",
      "Vitor - Fam√≠lia Mendes",
      "Marcos - Fam√≠lia Mendes",
      "Mayara - Fam√≠lia Mendes",
      "Edinho - Fam√≠lia Mendes",
      "Lucas Mayara - Fam√≠lia Mendes",
      "Tia Edi - Fam√≠lia Mendes",
      "Dioni - Fam√≠lia Mendes",
      "Maria Mendes - Fam√≠lia Mendes",
      "Namorado Maria - Fam√≠lia Mendes",
      "Eliane - Fam√≠lia Mendes",
      "Jo√£o - Fam√≠lia Mendes",
      "Nega - Fam√≠lia Mendes",
      "Edmilson - Fam√≠lia Mendes",
      "Anderson - Fam√≠lia Mendes",
      "Carol - Fam√≠lia Mendes",
      "Helena - Fam√≠lia Mendes",
      "Derick - Fam√≠lia Mendes",
      "Duda - Fam√≠lia Mendes",
      "Nicolas - Fam√≠lia Mendes",
      "Jauri - Amigos",
      "Daura - Amigos",
      "Manu - Amigos",
      "Ju - Amigos",
      "Max - Amigos",
      "Monica - Amigos",
      "Julia Monica - Amigos",
      "Joaquim - Amigos",
      "Cris - Amigos",
      "Denner - Amigos",
      "Livia - Amigos",
      "Antoni - Amigos",
      "Bode - Amigos",
      "Kemily - Amigos",
      "Chancho - Amigos",
      "Mulher Chancho - Amigos",
      "Ju Ease - Amigos",
      "Paulo Ju - Amigos",
      "Luana - Amigos",
      "Lucas Luana - Amigos",
      "Enzo - Amigos",
      "Paulo - Amigos",
      "Angela - Amigos",
      "Maria Loja - Amigos",
      "Erick Maria - Amigos",
      "Mayara Ju - Amigos",
      "Ezequiel - Amigos",
      "Mariane - Amigos",
      "Hilario - Amigos",
      "Afonso - Amigos",
      "Gabi Afonso - Amigos"
    ];

    // Preenche lista
    const lista = document.getElementById("nomes");
    convidados.forEach(nome => {
      const opt = document.createElement("option");
      opt.value = nome;
      opt.textContent = nome;
      lista.appendChild(opt);
    });

    function filtrarNomes() {
      const termo = document.getElementById("search").value.toLowerCase();
      lista.innerHTML = "";
      convidados.filter(n => n.toLowerCase().includes(termo))
        .forEach(n => {
          const opt = document.createElement("option");
          opt.value = n;
          opt.textContent = n;
          lista.appendChild(opt);
        });
    }

    function enviarResposta() {
      const selecionados = Array.from(lista.selectedOptions).map(o => o.value);
      const observacao = document.getElementById("observacao").value;

      if (selecionados.length === 0) {
        alert("Selecione pelo menos um nome!");
        return;
      }

      fetch(SCRIPT_URL, {
        method: "POST",
        body: new URLSearchParams({
          nomes: selecionados.join(", "),
          observacao: observacao
        })
      })
      .then(() => {
        document.getElementById("mensagem").textContent = "Presen√ßa confirmada com sucesso! üíö";
        document.getElementById("observacao").value = "";
      })
      .catch(() => {
        document.getElementById("mensagem").textContent = "Erro ao enviar. Tente novamente.";
      });
    }
  </script>
</body>
</html>
